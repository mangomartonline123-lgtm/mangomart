<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=5.0, user-scalable=yes">
    <meta name="theme-color" content="#059669">
    <meta name="description" content="Your Orders - Mango Mart">
    <link rel="manifest" href="manifest.webmanifest">
    <link rel="canonical" href="orders.html">
    <meta property="og:title" content="Your Orders - Mango Mart">
    <meta property="og:description" content="Track and manage your Mango Mart orders.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="orders.html">
    <meta property="og:image" content="icons/icon-512.png">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Your Orders - Mango Mart">
    <meta name="twitter:description" content="Track and manage your Mango Mart orders.">
    <meta name="twitter:image" content="icons/icon-512.png">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Your Orders - Mango Mart</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="styles/main.css">
</head>
<body class="orders-body bg-gray-50">
    <div id="orders-loading-overlay" class="orders-loading-overlay">
        <div class="orders-loading-card">
            <div class="orders-loading-icon">
                <div class="orders-loading-spinner"></div>
            </div>
            <p class="orders-loading-title">Loading your orders</p>
            <p class="orders-loading-subtitle">Fetching the freshest updates for your deliveries…</p>
        </div>
    </div>

    <!-- Header -->
    <header class="orders-header bg-white shadow-sm border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center h-16">
                <!-- Left Section -->
                <div class="flex items-center">
                    <button id="orders-back-btn" type="button" class="orders-back-btn flex items-center text-gray-600 hover:text-emerald-600 transition-colors mr-4 bg-transparent border-0 p-0">
                        <i data-lucide="arrow-left" class="w-6 h-6"></i>
                    </button>
                    <div class="flex-shrink-0">
                        <h1 class="text-2xl font-bold text-emerald-600">Mango Mart</h1>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="orders-main max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-10 space-y-10">
        <!-- Hero / Overview -->
        <!-- Orders Header -->
        <section class="orders-header-simple text-center space-y-3">
            <h1 class="orders-title text-3xl font-bold text-gray-900">Your Orders</h1>
            <p class="orders-subtitle text-gray-600">Track and manage your orders</p>
            <div id="user-info" class="orders-user text-sm text-gray-500"></div>
        </section>

        <!-- Orders List -->
        <div id="orders-container">
            <!-- Orders will be loaded dynamically here -->
        </div>

    </main>

    <script>
        // Prevent main app initialization on orders page
        window.ORDERS_PAGE = true;
    </script>
    <script src="js/mango-mart.js"></script>
    <script>
        // Initialize Supabase client (using global variables from mango-mart.js)
        let ordersSupabase;
        if (typeof window.supabase !== 'undefined') {
            // Use the global Supabase URL and key from mango-mart.js
            const supabaseUrl = 'https://nruafgayqspvluubsvwb.supabase.co';
            const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im5ydWFmZ2F5cXNwdmx1dWJzdndiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjA4ODI1MTcsImV4cCI6MjA3NjQ1ODUxN30.hhnZq-mF24RYW9SfnorFNw-Wl51bK_mfDjQiN2WCNcA';
            ordersSupabase = window.supabase.createClient(supabaseUrl, supabaseKey);
            console.log('Supabase client initialized in orders.html');
        } else {
            console.error('Supabase module not loaded');
        }
        
        // Initialize Lucide icons with retry logic
        function initLucideIcons() {
            if (typeof lucide !== 'undefined' && window.lucide) {
                try {
                    lucide.createIcons();
                    console.log('✅ Lucide icons initialized');
                } catch (error) {
                    console.warn('⚠️ Error initializing icons:', error);
                }
            } else {
                // Retry after a short delay
                setTimeout(initLucideIcons, 200);
            }
        }
        
        // Initialize icons after DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', initLucideIcons);
        } else {
            initLucideIcons();
        }

        const ordersLoadingOverlay = document.getElementById('orders-loading-overlay');
        let ordersLoadingTimeout;

        function hideOrdersLoadingOverlay(delay = 150) {
            if (!ordersLoadingOverlay) return;
            clearTimeout(ordersLoadingTimeout);
            ordersLoadingTimeout = setTimeout(() => {
                ordersLoadingOverlay.classList.add('orders-loading-overlay--hidden');
                setTimeout(() => {
                    ordersLoadingOverlay.remove();
                }, 450);
            }, delay);
        }

        const ORDERS_CACHE_PREFIX = 'orders_cache_';

        function getOrdersCacheKey(userId) {
            return `${ORDERS_CACHE_PREFIX}${userId}`;
        }

    function redirectToHome() {
        const targetUrl = new URL('index.html', window.location.href);
        window.location.href = targetUrl.href;
    }

    function loadOrdersFromCache(session) {
            if (!session || !session.user) return null;
            try {
                const cacheKey = getOrdersCacheKey(session.user.id);
                const cached = JSON.parse(localStorage.getItem(cacheKey) || 'null');
                if (cached && Array.isArray(cached.orders)) {
                    console.log(`Loaded ${cached.orders.length} orders from cache`);
                    return cached.orders;
                }
            } catch (error) {
                console.warn('Failed to parse orders cache:', error);
            }
            return null;
        }

        function saveOrdersToCache(session, orders) {
            if (!session || !session.user) return;
            try {
                const cacheKey = getOrdersCacheKey(session.user.id);
                localStorage.setItem(cacheKey, JSON.stringify({
                    orders,
                    timestamp: Date.now()
                }));
            } catch (error) {
                console.warn('Failed to save orders cache:', error);
            }
        }

        // Load orders from Supabase (user-specific)
        async function loadOrders() {
            // Get current user session
            const session = JSON.parse(localStorage.getItem('session') || 'null');
            if (!session || !session.user) {
                // Redirect to login if not authenticated
                redirectToHome();
                hideOrdersLoadingOverlay(0);
                return;
            }

            console.log('Current user:', session.user);
            console.log('User ID:', session.user.id);
            console.log('User Email:', session.user.email);
            console.log('User Mobile:', session.user.mobile);
            
            const cachedOrders = loadOrdersFromCache(session);
            if (cachedOrders) {
                renderOrders(cachedOrders);
                hideOrdersLoadingOverlay(250);
            }

            try {
                // Load orders from Supabase using the client
                if (ordersSupabase) {
                    const { data: allOrders, error } = await ordersSupabase
                        .from('orders')
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    if (error) {
                        throw error;
                    }
                    
                    console.log('All orders from Supabase:', allOrders);
                    console.log('Total orders found:', allOrders.length);
                
                    // Filter orders for current user only
                    console.log('=== FILTERING ORDERS ===');
                    console.log('Current user session:', session.user);
                    console.log('User ID:', session.user.id);
                    console.log('User Email:', session.user.email);
                    console.log('User Mobile:', session.user.mobile);
                    
                    const orders = allOrders.filter(order => {
                        // Primary filter: customer_id must match user ID
                        const matchById = order.customer_id === session.user.id;
                        
                        console.log(`Order ${order.id}:`);
                        console.log(`  - Order customer_id: "${order.customer_id}" (type: ${typeof order.customer_id})`);
                        console.log(`  - Session user.id: "${session.user.id}" (type: ${typeof session.user.id})`);
                        console.log(`  - Match result: ${matchById}`);
                        console.log(`  - order.customer_id type: ${typeof order.customer_id}, value: ${JSON.stringify(order.customer_id)}`);
                        console.log(`  - session.user.id type: ${typeof session.user.id}, value: ${JSON.stringify(session.user.id)}`);
                        
                        // Also try string comparison in case of type mismatch
                        const stringMatch = String(order.customer_id) === String(session.user.id);
                        console.log(`  - String match (fallback): ${stringMatch}`);
                        
                        // Return true if either matches
                        return matchById || stringMatch;
                    });
                    
                    console.log('User orders after filtering:', orders.length);
                    saveOrdersToCache(session, orders);
                    renderOrders(orders);
                    hideOrdersLoadingOverlay(cachedOrders ? 200 : 0);
                } else {
                    throw new Error('Supabase client not available');
                }
                
            } catch (error) {
                console.error('Error loading orders:', error);
                // Fallback to localStorage
                if (cachedOrders) {
                    // Already rendered from cache; just log
                    console.log('Displayed cached orders after Supabase error.');
                } else {
                    const allOrders = JSON.parse(localStorage.getItem('orders') || '[]');
                    const orders = allOrders.filter(order => 
                        order.customerId === session.user.id || 
                        order.customerEmail === session.user.email ||
                        order.customerMobile === session.user.mobile
                    );
                    renderOrders(orders);
                }
                hideOrdersLoadingOverlay(cachedOrders ? 200 : 0);
            }
        }

        // Render orders function
        function renderOrders(orders) {
            const session = JSON.parse(localStorage.getItem('session') || 'null');
            const ordersContainer = document.getElementById('orders-container');
            
            console.log('=== RENDER ORDERS CALLED ===');
            console.log('Loading orders for user:', session?.user?.name);
            console.log('User orders:', orders);
            console.log('Orders container:', ordersContainer);
            console.log('Orders length:', orders.length);

            // Display user info
            const userInfo = document.getElementById('user-info');
            if (userInfo && session?.user) {
                userInfo.innerHTML = `
                    <span class="font-medium">Welcome, ${session.user.name}!</span>
                    ${session.user.email ? `<span class="ml-2">(${session.user.email})</span>` : ''}
                    ${session.user.mobile ? `<span class="ml-2">(${session.user.mobile})</span>` : ''}
                `;
            }
            
            if (orders.length === 0) {
                console.log('No orders found, showing empty state');
                // Show empty state
                ordersContainer.innerHTML = `
                    <div class="text-center py-12">
                        <i data-lucide="package" class="w-16 h-16 text-gray-400 mx-auto mb-4"></i>
                        <h3 class="text-xl font-semibold text-gray-900 mb-2">No orders found</h3>
                        <p class="text-gray-600 mb-6">Start shopping to see your orders here</p>
                        <a href="/" class="bg-emerald-600 text-white px-6 py-3 rounded-lg hover:bg-emerald-700 transition-colors inline-flex items-center">
                            <i data-lucide="shopping-bag" class="w-4 h-4 mr-2"></i>
                            Start Shopping
                        </a>
                    </div>
                `;
                try {
                    if (window.lucide && typeof window.lucide.createIcons === 'function') {
                        window.lucide.createIcons();
                    }
                } catch (error) {
                    console.warn('⚠️ Error initializing icons in empty state:', error);
                }
                hideOrdersLoadingOverlay();
                return;
            }

            console.log('Rendering orders, total count:', orders.length);
            try {
                window.ordersDataMap = {};
                orders.forEach(order => {
                    if (order && order.id !== undefined && order.id !== null) {
                        window.ordersDataMap[String(order.id)] = order;
                    }
                });
            } catch (error) {
                console.warn('Failed to cache orders for reorder:', error);
            }
            
            // Separate current and previous orders
            const classifyOrder = (order) => {
                const status = (order.status || 'pending').toString().toLowerCase();
                const deliveryStatus = (order.delivery_status || 'pending').toString().toLowerCase();
                
                if (deliveryStatus === 'delivered' || status === 'delivered' || status === 'cancelled') {
                    return 'previous';
                }
                
                return 'current';
            };
            
            const currentOrders = orders.filter(order => classifyOrder(order) === 'current');
            const previousOrders = orders.filter(order => classifyOrder(order) === 'previous');
            
            console.log('Current orders:', currentOrders.length);
            console.log('Previous orders:', previousOrders.length);

            // Render orders
            ordersContainer.innerHTML = `
                <!-- Current Orders Section -->
                <div class="orders-section-card mb-10">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h3 class="orders-section-title text-2xl font-bold text-gray-900">Current Orders</h3>
                            <p class="orders-section-subtitle mt-1">Track items being prepared or out for delivery.</p>
                        </div>
                        <span class="orders-section-chip bg-emerald-100 text-emerald-800 text-sm font-medium rounded-full">${currentOrders.length} Active</span>
                    </div>
                    
                    <div class="space-y-6">
                        ${currentOrders.map(order => renderOrderCard(order)).join('')}
                    </div>
                </div>

                <!-- Previous Orders Section -->
                <div class="orders-section-card">
                    <div class="flex items-center justify-between mb-6">
                        <div>
                            <h3 class="orders-section-title text-2xl font-bold text-gray-900">Previous Orders</h3>
                            <p class="orders-section-subtitle mt-1">Review your delivered and cancelled orders.</p>
                        </div>
                        <span class="orders-section-chip bg-gray-100 text-gray-800 text-sm font-medium rounded-full">${previousOrders.length} Completed</span>
                    </div>
                    
                    <div class="space-y-6">
                        ${previousOrders.map(order => renderOrderCard(order)).join('')}
                    </div>
                </div>
            `;

            // Re-initialize icons with proper error handling
            try {
                if (window.lucide && typeof window.lucide.createIcons === 'function') {
                    window.lucide.createIcons();
                    console.log('✅ Icons initialized after render');
                } else {
                    console.warn('⚠️ Lucide not available, using text labels');
                }
            } catch (error) {
                console.warn('⚠️ Error initializing icons:', error);
                // Continue anyway - icons just won't show
            }

            // Attach event listeners to new buttons
            attachOrderEventListeners();
            hideOrdersLoadingOverlay();
        }

        // Render individual order card
        function renderOrderCard(order) {
            console.log('Rendering order card:', order);
            
            const statusColors = {
                'pending': 'bg-yellow-100 text-yellow-800',
                'confirmed': 'bg-blue-100 text-blue-800',
                'preparing': 'bg-orange-100 text-orange-800',
                'ready': 'bg-purple-100 text-purple-800',
                'picked_up': 'bg-cyan-100 text-cyan-800',
                'out_for_delivery': 'bg-indigo-100 text-indigo-800',
                'delivered': 'bg-green-100 text-green-800',
                'cancelled': 'bg-red-100 text-red-800'
            };

            const statusText = {
                'pending': 'Pending',
                'confirmed': 'Confirmed',
                'preparing': 'Preparing',
                'ready': 'Ready',
                'picked_up': 'Picked Up',
                'out_for_delivery': 'Out for Delivery',
                'delivered': 'Delivered',
                'cancelled': 'Cancelled'
            };

            const orderDate = new Date(order.created_at || order.createdAt).toLocaleDateString('en-IN', {
                day: 'numeric',
                month: 'short',
                year: 'numeric'
            });

            // Handle different order status formats
            const rawOrderStatus = (order.status || 'pending').toString().toLowerCase();
            const orderPaymentStatus = (order.payment_status || order.paymentStatus || '').toString().toLowerCase();
            const orderPaymentMethod = (order.payment_method || order.paymentMethod || '').toString().toLowerCase();
            const deliveryStatusRaw = (order.delivery_status || 'pending').toString().toLowerCase();
            const primaryStatus = (deliveryStatusRaw && deliveryStatusRaw !== 'pending')
                ? deliveryStatusRaw
                : rawOrderStatus;
            
            const orderStatus = primaryStatus;
            const deliveryStatus = deliveryStatusRaw;

            // Order is current if it's not delivered/cancelled and delivery status is not delivered
            const isCurrentOrder = !['delivered', 'cancelled'].includes(primaryStatus);

            return `
                <div class="orders-order-card bg-white rounded-lg shadow-sm border border-gray-200 p-6">
                    <div class="flex items-start justify-between mb-4">
                        <div>
                            <h3 class="orders-order-title text-lg font-semibold text-gray-900">Order #${order.id}</h3>
                            <p class="orders-order-subtitle text-sm text-gray-600">Placed on ${orderDate}</p>
                        </div>
                        <div class="flex items-center space-x-2">
                            ${order.delivery_agent_name ? `
                                <span class="orders-status-chip px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800">
                                    Agent: ${order.delivery_agent_name}
                                </span>
                            ` : ''}
                        </div>
                    </div>
                    
                    <div class="space-y-3 mb-4">
                        ${order.items && order.items.length > 0 ? order.items.map(item => `
                            <div class="orders-item-row flex items-center space-x-3">
                                <img src="${item.image || item.product_image || 'https://images.unsplash.com/photo-1605027990121-75fd594d6565?w=400'}" 
                                     alt="${item.name || item.product_name || 'Product'}" 
                                     class="orders-item-thumb w-12 h-12 rounded-lg object-cover">
                                <div class="flex-1">
                                    <h4 class="orders-item-title text-sm font-medium text-gray-900">${item.name || item.product_name || 'Product'}</h4>
                                    <p class="orders-item-meta text-sm text-gray-600">Qty: ${item.quantity || 1} × ₹${item.price || item.product_price || 0}</p>
                                    ${item.description ? `<p class="orders-item-desc text-xs text-gray-500 mt-1">${item.description.substring(0, 40)}...</p>` : ''}
                                </div>
                                <div class="orders-item-total text-sm font-medium text-gray-900">
                                    ₹${((item.price || item.product_price || 0) * (item.quantity || 1)).toFixed(2)}
                                </div>
                            </div>
                        `).join('') : `
                            <div class="orders-item-row flex items-center space-x-3">
                                <div class="orders-item-thumb w-12 h-12 rounded-lg bg-gray-200 flex items-center justify-center">
                                    <i data-lucide="package" class="orders-item-icon w-6 h-6 text-gray-400"></i>
                                </div>
                                <div class="flex-1">
                                    <h4 class="orders-item-title text-sm font-medium text-gray-900">Order Items</h4>
                                    <p class="orders-item-meta text-sm text-gray-600">Items details not available</p>
                                </div>
                                <div class="orders-item-total text-sm font-medium text-gray-900">
                                    ₹${order.total_amount || order.total || order.totalAmount || 0}
                                </div>
                            </div>
                        `}
                    </div>
                    
                    <div class="orders-order-footer border-t pt-4">
                        <div class="flex justify-between items-center">
                                <div class="orders-order-summary text-sm text-gray-600">
                                <p>Total: <span class="orders-order-total font-semibold text-lg text-gray-900">₹${(order.total_amount || order.totalAmount || order.total || 0).toFixed(2)}</span></p>
                        <p class="orders-payment-chip flex items-center gap-2">
                                    <span class="payments-chip inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${
                                        orderPaymentStatus === 'paid'
                                            ? 'bg-emerald-100 text-emerald-700'
                                            : 'bg-amber-100 text-amber-700'
                                    }">
                                        ${
                                            orderPaymentStatus === 'paid'
                                                ? '<i data-lucide="check-circle" class="w-3 h-3"></i> Paid Online'
                                                : '<i data-lucide="wallet" class="w-3 h-3"></i> Cash on Delivery'
                                        }
                                    </span>
                                </p>
                                ${order.delivery_status ? `
                                    <p class="text-sm text-gray-600">
                                        <strong>Delivery Status:</strong> 
                                        <span class="${getDeliveryStatusClass(order.delivery_status)} px-2 py-1 rounded-full text-xs">
                                            ${getDeliveryStatusText(order.delivery_status)}
                                        </span>
                                    </p>
                                ` : ''}
                                ${order.delivery_agent_name ? `<p class="text-sm text-gray-600"><strong>Delivery Agent:</strong> ${order.delivery_agent_name}</p>` : ''}
                                ${orderStatus === 'delivered' ? `<p class="text-green-600">Delivered on ${new Date(order.paid_at || order.paidAt || order.created_at || order.createdAt).toLocaleDateString('en-IN')}</p>` : ''}
                                ${orderStatus === 'picked_up' ? '<p class="text-blue-600">Order picked up and ready for delivery</p>' : ''}
                            </div>
                                <div class="orders-order-actions flex space-x-2">
                                ${isCurrentOrder && orderStatus === 'pending'
                                    ? '<button class="orders-btn-secondary px-4 py-2 text-sm text-red-600 hover:text-red-700 transition-colors border border-red-300 rounded-lg hover:bg-red-50 cancel-order" data-order-id="' + order.id + '">Cancel Order</button>'
                                    : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        // Attach event listeners to order action buttons
        function attachOrderEventListeners() {
            // Track order
            document.querySelectorAll('.track-order').forEach(btn => {
                btn.addEventListener('click', () => {
                    alert('Order tracking feature coming soon!');
                });
            });

            // Cancel order
            document.querySelectorAll('.cancel-order').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const orderId = e.target.dataset.orderId;
                    if (confirm('Are you sure you want to cancel this order?')) {
                        // Update order status to cancelled
                        const orders = JSON.parse(localStorage.getItem('orders') || '[]');
                        const orderIndex = orders.findIndex(order => order.id === orderId);
                        if (orderIndex !== -1) {
                            orders[orderIndex].status = 'cancelled';
                            localStorage.setItem('orders', JSON.stringify(orders));
                            loadOrders(); // Reload orders
                            alert('Order cancelled successfully!');
                        }
                    }
                });
            });

            // Reorder
            // Reorder button removed
        }

        // Fallback formatCurrency function if not available
        function formatCurrency(amount) {
            if (typeof window.formatCurrency === 'function') {
                return window.formatCurrency(amount);
            }
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR'
            }).format(amount);
        }


        // Listen for order changes from other pages
        window.addEventListener('storage', (e) => {
            if (e.key === 'orders') {
                console.log('Orders updated in localStorage, reloading...');
                loadOrders();
            }
        });

        // Listen for custom order events
        window.addEventListener('orderCreated', () => {
            console.log('Order created event received, reloading orders...');
            loadOrders();
        });

        // Clean up orders without proper user information
        function cleanupOrders() {
            const allOrders = JSON.parse(localStorage.getItem('orders') || '[]');
            const session = JSON.parse(localStorage.getItem('session') || 'null');
            
            if (!session || !session.user) return;
            
            // Find orders that don't belong to any user (orphaned orders)
            const orphanedOrders = allOrders.filter(order => 
                !order.customerId && !order.customerEmail && !order.customerMobile
            );
            
            if (orphanedOrders.length > 0) {
                console.log('Found orphaned orders:', orphanedOrders);
                // Remove orphaned orders
                const cleanOrders = allOrders.filter(order => 
                    order.customerId || order.customerEmail || order.customerMobile
                );
                localStorage.setItem('orders', JSON.stringify(cleanOrders));
                console.log('Cleaned up orphaned orders');
            }
        }


        // Load orders when page loads
        document.addEventListener('DOMContentLoaded', () => {
            console.log('DOM loaded, loading orders...');
            console.log('Supabase client status:', !!ordersSupabase);
            
            if (ordersSupabase) {
                console.log('✅ Supabase client is ready');
            } else {
                console.error('❌ Supabase client not initialized');
            }
            
            const backBtn = document.getElementById('orders-back-btn');
            if (backBtn) {
                backBtn.addEventListener('click', (event) => {
                    event.preventDefault();
                    if (window.history.length > 1) {
                        window.history.back();
                    } else {
                        redirectToHome();
                    }
                });
            }
            
            cleanupOrders(); // Clean up orphaned orders
            loadOrders();
        });

        // Delivery status helper functions
        function getDeliveryStatusText(status) {
            const statusMap = {
                'pending': 'Pending Pickup',
                'picked_up': 'Picked Up',
                'out_for_delivery': 'Out for Delivery',
                'delivered': 'Delivered'
            };
            return statusMap[status] || status;
        }

        function getDeliveryStatusClass(status) {
            const statusColors = {
                'pending': 'bg-yellow-100 text-yellow-800',
                'picked_up': 'bg-blue-100 text-blue-800',
                'out_for_delivery': 'bg-purple-100 text-purple-800',
                'delivered': 'bg-green-100 text-green-800'
            };
            return statusColors[status] || 'bg-gray-100 text-gray-800';
        }
    </script>
</body>
</html>


